---
import type {
  PagePayload,
  Hero,
  Grid,
  Emphasis,
  Presentation,
  Quote,
  FAQ,
  Index,
  CTA,
  PageNavigation,
} from "../../types/index";
import InnerHeroSection from "../PageSections/InnerHero.astro";
import InnerGridSection from "../PageSections/InnerGrid.astro";
import EmphasisSection from "../PageSections/Emphasis.astro";
import PresentationSection from "../PageSections/Presentation.astro";
import IndexSection from "../PageSections/IndexSection.astro";
import FAQSection from "../PageSections/FAQSection.astro";
import QuoteSection from "../PageSections/Quote.astro";
import CallToActionSection from "../PageSections/CallToAction.astro";
import buildPageNav from "../../utils/buildPageNav";
import type { PortableTextBlock } from "sanity";

type Props = {
  page: PagePayload;
};

const { page } = Astro.props;

const pageNavigation: PageNavigation = buildPageNav(page.content);
---

<Fragment>
  {
    page.content.map((section, idx) => {
      switch (section.type) {
        case "hero":
          return (
            <InnerHeroSection
              content={section as Hero}
              navigation={pageNavigation}
            />
          );
        case "grid":
          return <InnerGridSection content={section as Grid} />;
        case "presentation":
          return <PresentationSection content={section as Presentation} />;
        case "emphasis":
          return <EmphasisSection content={section as Emphasis} />;
        case "quote":
          return <QuoteSection content={section as Quote} />;
        case "faq":
          return <FAQSection content={section as FAQ} />;
        case "index":
          // should probably make padding/background dynamic/controllable through Sanity
          return (
            <IndexSection
              content={section as Index}
              padding={idx === 3}
              background={idx === 3}
            />
          );
        case "cta":
          return <CallToActionSection content={section as CTA} />;
        default:
          return null;
      }
    })
  }
</Fragment>
<!-- <h1>{page.title}</h1>
<p>{page.slug}</p>
<article>
  {
    page.content.map((section) => (
      <div>
        <>
          <h2>{section.title || "Section"}</h2>
          <p>{section.type}</p>
        </>
      </div>
    ))
  }
</article> -->
